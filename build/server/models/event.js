// Generated by CoffeeScript 1.8.0
var Event, VAlarm, VCalendar, VEvent, VTodo, americano, moment, time, _ref;

americano = require('americano-cozy');

time = require('time');

moment = require('moment');

_ref = require('../lib/ical_helpers'), VCalendar = _ref.VCalendar, VTodo = _ref.VTodo, VAlarm = _ref.VAlarm, VEvent = _ref.VEvent;

module.exports = Event = americano.getModel('Event', {
  id: {
    type: String,
    "default": null
  },
  caldavuri: String,
  start: String,
  end: String,
  place: {
    type: String,
    "default": ''
  },
  details: {
    type: String,
    "default": ''
  },
  description: {
    type: String,
    "default": ''
  },
  rrule: String,
  attendees: {
    type: [Object]
  },
  related: {
    type: String,
    "default": null
  },
  timezone: {
    type: String
  },
  alarms: {
    type: [Object]
  }
});

require('cozy-ical').decorateEvent(Event);

Event.dateFormat = 'YYYY-MM-DD';

Event.ambiguousDTFormat = 'YYYY-MM-DD[T]HH:mm:00.000';

Event.utcDTFormat = 'YYYY-MM-DD[T]HH:mm:00.000[Z]';

Event.alarmTriggRegex = /(\+?|-)PT?(\d+)(W|D|H|M|S)/;

Event.all = function(cb) {
  return Event.request('byURI', cb);
};

Event.byURI = function(uri, cb) {
  var req;
  req = Event.request('byURI', null, cb);
  req.body = JSON.stringify({
    key: uri
  });
  return req.setHeader('content-type', 'application/json');
};
